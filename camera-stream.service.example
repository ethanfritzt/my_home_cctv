# camera-stream.service.example
# Example systemd service file for camera streaming
#
# IMPORTANT: This file is automatically configured by init-camera-node.sh
# The script will:
#   - Copy this file to /etc/systemd/system/camera-stream.service
#   - Add SERVER_IP and STREAM_NAME environment variables
#   - Update the ExecStart path to match your installation
#
# Do NOT manually copy this file. Instead, run:
#    sudo /home/pi/my_home_cctv/scripts/init-camera-node.sh
#
# MANAGEMENT:
#    sudo systemctl status camera-stream    # Check status
#    sudo systemctl start camera-stream     # Start streaming
#    sudo systemctl stop camera-stream      # Stop streaming
#    sudo systemctl restart camera-stream   # Restart streaming
#    sudo systemctl enable camera-stream    # Enable auto-start on boot
#    journalctl -u camera-stream -f         # View live logs

[Unit]
Description=Camera Stream to MediaMTX
After=network-online.target
Wants=network-online.target

# Environment variables
# These are automatically set by init-camera-node.sh:
# - SERVER_IP: IP address of the MediaMTX server
# - STREAM_NAME: Unique name for this camera's stream

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi
ExecStart=/home/pi/scripts/publish-stream.sh
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal
Environment="HOME=/home/pi"

[Install]
WantedBy=multi-user.target
